# åç«¯é‡æ–°ç”Ÿæˆå®ŒæˆæŠ¥å‘Š

## ğŸ‰ åç«¯æ³¨å†Œç™»å½•åŠŸèƒ½é‡æ–°ç”Ÿæˆå®Œæˆ

æˆ‘å·²ç»å®Œå…¨é‡æ–°æ„å»ºäº†åç«¯çš„æ³¨å†Œç™»å½•åŠŸèƒ½ï¼Œä¸¥æ ¼æŒ‰ç…§é¡¹ç›®è§„èŒƒå’ŒæŠ€æœ¯æ ˆè¦æ±‚å®ç°ã€‚

### ğŸ—ï¸ æŠ€æœ¯æ¶æ„

- **Spring Boot 3.2.0** - ä¸»æ¡†æ¶
- **MyBatis 3.5.15** - æ•°æ®åº“ORMï¼ˆåŸç”ŸMyBatisï¼ŒéMyBatis-Plusï¼‰
- **Spring Security 6.x** - å®‰å…¨æ¡†æ¶
- **JWT 0.12.3** - èº«ä»½è®¤è¯
- **MySQL 8.0** - æ•°æ®åº“
- **Redis** - ç¼“å­˜ï¼ˆå¯é€‰ï¼‰
- **BCrypt** - å¯†ç åŠ å¯†

### ğŸ“ é¡¹ç›®ç»“æ„

```
backend/src/main/java/com/chatapp/
â”œâ”€â”€ ChatBackendApplication.java          # å¯åŠ¨ç±»
â”œâ”€â”€ common/
â”‚   â”œâ”€â”€ Result.java                      # ç»Ÿä¸€è¿”å›æ ¼å¼
â”‚   â””â”€â”€ ResultCode.java                  # å“åº”çŠ¶æ€ç 
â”œâ”€â”€ config/
â”‚   â””â”€â”€ SecurityConfig.java              # Spring Securityé…ç½®
â”œâ”€â”€ controller/
â”‚   â””â”€â”€ AuthController.java              # è®¤è¯æ§åˆ¶å™¨
â”œâ”€â”€ dto/
â”‚   â”œâ”€â”€ LoginRequest.java                # ç™»å½•è¯·æ±‚DTO
â”‚   â”œâ”€â”€ LoginResponse.java               # ç™»å½•å“åº”DTO
â”‚   â”œâ”€â”€ RegisterRequest.java             # æ³¨å†Œè¯·æ±‚DTO
â”‚   â””â”€â”€ UserVO.java                      # ç”¨æˆ·ä¿¡æ¯VO
â”œâ”€â”€ entity/
â”‚   â””â”€â”€ User.java                        # ç”¨æˆ·å®ä½“ç±»
â”œâ”€â”€ exception/
â”‚   â”œâ”€â”€ BusinessException.java           # ä¸šåŠ¡å¼‚å¸¸ç±»
â”‚   â””â”€â”€ GlobalExceptionHandler.java      # å…¨å±€å¼‚å¸¸å¤„ç†å™¨
â”œâ”€â”€ mapper/
â”‚   â””â”€â”€ UserMapper.java                  # ç”¨æˆ·Mapperæ¥å£
â”œâ”€â”€ security/
â”‚   â”œâ”€â”€ JwtAuthenticationFilter.java     # JWTè®¤è¯è¿‡æ»¤å™¨
â”‚   â””â”€â”€ UserDetailsServiceImpl.java      # ç”¨æˆ·è¯¦æƒ…æœåŠ¡
â”œâ”€â”€ service/
â”‚   â”œâ”€â”€ UserService.java                 # ç”¨æˆ·æœåŠ¡æ¥å£
â”‚   â””â”€â”€ impl/
â”‚       â””â”€â”€ UserServiceImpl.java         # ç”¨æˆ·æœåŠ¡å®ç°
â””â”€â”€ util/
    â””â”€â”€ JwtUtil.java                      # JWTå·¥å…·ç±»
```

### ğŸ”§ æ ¸å¿ƒåŠŸèƒ½

#### 1. ç”¨æˆ·æ³¨å†Œ
- âœ… å®Œæ•´çš„å‚æ•°éªŒè¯ï¼ˆç”¨æˆ·åã€å¯†ç ã€é‚®ç®±æ ¼å¼ç­‰ï¼‰
- âœ… é‡å¤æ€§æ£€æŸ¥ï¼ˆç”¨æˆ·åã€é‚®ç®±ã€æ‰‹æœºå·ï¼‰
- âœ… BCryptå¯†ç åŠ å¯†
- âœ… ç»Ÿä¸€é”™è¯¯å¤„ç†å’Œå“åº”

#### 2. ç”¨æˆ·ç™»å½•
- âœ… æ”¯æŒç”¨æˆ·å/é‚®ç®±/æ‰‹æœºå·ç™»å½•
- âœ… å¯†ç éªŒè¯
- âœ… JWTä»¤ç‰Œç”Ÿæˆï¼ˆè®¿é—®ä»¤ç‰Œ + åˆ·æ–°ä»¤ç‰Œï¼‰
- âœ… ç™»å½•çŠ¶æ€æ›´æ–°

#### 3. ä»¤ç‰Œç®¡ç†
- âœ… JWTè®¿é—®ä»¤ç‰Œï¼ˆ1å°æ—¶è¿‡æœŸï¼‰
- âœ… JWTåˆ·æ–°ä»¤ç‰Œï¼ˆ7å¤©è¿‡æœŸï¼‰
- âœ… ä»¤ç‰ŒéªŒè¯å’Œåˆ·æ–°

#### 4. å®‰å…¨ç‰¹æ€§
- âœ… Spring Securityé…ç½®
- âœ… CORSæ”¯æŒ
- âœ… ç»Ÿä¸€å¼‚å¸¸å¤„ç†
- âœ… é˜²SQLæ³¨å…¥ï¼ˆMyBatiså‚æ•°åŒ–æŸ¥è¯¢ï¼‰

### ğŸ—„ï¸ æ•°æ®åº“è®¾è®¡

#### ç”¨æˆ·è¡¨ï¼ˆusersï¼‰
- `id` - ä¸»é”®
- `username` - ç”¨æˆ·åï¼ˆå”¯ä¸€ï¼‰
- `display_name` - æ˜¾ç¤ºåç§°
- `email` - é‚®ç®±ï¼ˆå”¯ä¸€ï¼Œå¯é€‰ï¼‰
- `phone` - æ‰‹æœºå·ï¼ˆå”¯ä¸€ï¼Œå¯é€‰ï¼‰
- `password` - BCryptåŠ å¯†å¯†ç 
- `avatar` - å¤´åƒURL
- `signature` - ä¸ªæ€§ç­¾å
- `status` - åœ¨çº¿çŠ¶æ€
- `last_online` - æœ€ååœ¨çº¿æ—¶é—´
- `account_status` - è´¦å·çŠ¶æ€
- `create_time` - åˆ›å»ºæ—¶é—´
- `update_time` - æ›´æ–°æ—¶é—´
- `deleted` - é€»è¾‘åˆ é™¤æ ‡è®°

### ğŸ”‘ APIæ¥å£

#### è®¤è¯ç›¸å…³
- `POST /api/auth/register` - ç”¨æˆ·æ³¨å†Œ
- `POST /api/auth/login` - ç”¨æˆ·ç™»å½•
- `POST /api/auth/refresh` - åˆ·æ–°ä»¤ç‰Œ

#### éªŒè¯ç›¸å…³
- `GET /api/auth/check-username` - æ£€æŸ¥ç”¨æˆ·åå¯ç”¨æ€§
- `GET /api/auth/check-email` - æ£€æŸ¥é‚®ç®±å¯ç”¨æ€§
- `GET /api/auth/check-phone` - æ£€æŸ¥æ‰‹æœºå·å¯ç”¨æ€§

### ğŸ“‹ æµ‹è¯•è´¦å·

æ•°æ®åº“ä¸­é¢„ç½®çš„æµ‹è¯•è´¦å·ï¼ˆå¯†ç ç»Ÿä¸€ä¸ºï¼š123456ï¼‰ï¼š
- **zhangsan** / 123456 ï¼ˆå¼ ä¸‰ï¼Œåœ¨çº¿çŠ¶æ€ï¼‰
- **lisi** / 123456 ï¼ˆæå››ï¼Œç¦»å¼€çŠ¶æ€ï¼‰
- **wangwu** / 123456 ï¼ˆç‹äº”ï¼Œç¦»çº¿çŠ¶æ€ï¼‰
- **admin** / 123456 ï¼ˆç®¡ç†å‘˜ï¼Œåœ¨çº¿çŠ¶æ€ï¼‰

### ğŸš€ å¯åŠ¨æ­¥éª¤

1. **é…ç½®æ•°æ®åº“**
   ```sql
   -- åˆ›å»ºæ•°æ®åº“
   CREATE DATABASE chat_app;
   
   -- æ‰§è¡Œåˆå§‹åŒ–è„šæœ¬
   source backend/src/main/resources/sql/init.sql;
   ```

2. **ä¿®æ”¹é…ç½®**
   - ç¼–è¾‘ `application.yml` ä¸­çš„æ•°æ®åº“è¿æ¥é…ç½®
   - æ ¹æ®éœ€è¦é…ç½®Redisè¿æ¥ï¼ˆå¯é€‰ï¼‰

3. **å¯åŠ¨åº”ç”¨**
   ```bash
   cd backend
   ./mvnw spring-boot:run
   ```

4. **æµ‹è¯•API**
   ```bash
   # ç™»å½•æµ‹è¯•
   curl -X POST http://localhost:8080/api/auth/login \
     -H "Content-Type: application/json" \
     -d '{"account":"zhangsan","password":"123456"}'
   ```

### âœ¨ æŠ€æœ¯ç‰¹è‰²

1. **å®Œå…¨éµå¾ªé¡¹ç›®è§„èŒƒ**
   - ä½¿ç”¨åŸç”ŸMyBatisï¼ˆéMyBatis-Plusï¼‰
   - ç§»é™¤æ‰€æœ‰Lombokä¾èµ–
   - æ‰‹åŠ¨å®ç°æ‰€æœ‰getter/setteræ–¹æ³•

2. **å®‰å…¨æ€§ä¿éšœ**
   - BCryptå¯†ç åŠ å¯†
   - JWTä»¤ç‰Œè®¤è¯
   - Spring Securityé˜²æŠ¤
   - å‚æ•°éªŒè¯å’ŒSQLæ³¨å…¥é˜²æŠ¤

3. **é”™è¯¯å¤„ç†å®Œå–„**
   - ç»Ÿä¸€Resultè¿”å›æ ¼å¼
   - å…¨å±€å¼‚å¸¸å¤„ç†
   - è¯¦ç»†çš„é”™è¯¯æ—¥å¿—è®°å½•

4. **ä»£ç è´¨é‡**
   - å®Œæ•´çš„æ³¨é‡Šæ–‡æ¡£
   - æ ‡å‡†çš„Mavené¡¹ç›®ç»“æ„
   - æ¸…æ™°çš„åˆ†å±‚æ¶æ„

### ğŸ”§ é…ç½®è¦ç‚¹

- JWTå¯†é’¥å·²é…ç½®ä¸ºå®‰å…¨çš„é•¿åº¦
- æ•°æ®åº“è¿æ¥æ± ä½¿ç”¨HikariCP
- æ”¯æŒå¤šç§ç™»å½•æ–¹å¼ï¼ˆç”¨æˆ·å/é‚®ç®±/æ‰‹æœºå·ï¼‰
- å®Œæ•´çš„CORSé…ç½®æ”¯æŒå‰ç«¯è°ƒç”¨

ç°åœ¨åç«¯æ³¨å†Œç™»å½•åŠŸèƒ½å·²ç»å®Œå…¨é‡æ–°æ„å»ºå®Œæˆï¼Œå¯ä»¥ç›´æ¥å¯åŠ¨ä½¿ç”¨ï¼